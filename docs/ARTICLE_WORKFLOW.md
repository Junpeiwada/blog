# 記事作成ワークフロー

記事作成から公開までの統合ワークフローガイドです。作業漏れを防ぎ、効率的で高品質な記事作成を実現します。

## 🚀 記事作成の3ステップ

### Step 1: 画像処理・分析
Google Photos URLから自動的に画像分析と日時情報を抽出します。

GoglePhotosから写真のurlの取得とダウンロードを行うPythonスクリプトがあります。以下に従って実行してください

google_photos_extractor.pyは写真の枚数によって非常に時間がかかるのでタイムアウトを15分程度に設定して実行を待つ必要があります。
```bash
# Google Photos URL抽出
python scripts/google_photos_extractor.py "共有URL" --headless

# 画像ダウンロード・分析（自動でEXIF日時抽出・最適化URL生成・分析MD生成）
python scripts/download_images_for_review.py --clean [URL群] --article-title "記事タイトル"
```

**Step 1の出力**:
- `scripts/tmp/review_image_XX_HASH.jpg` - ダウンロードされた画像
- `scripts/tmp/image_analysis_YYYY-MM-DD-slug.md` - **時刻情報+最適化URL付き画像分析MD**

### Step 2: 記事作成
画像分析MDファイルの情報を参照して記事を作成します。

**Claude Codeでの作業**:
1. `scripts/tmp/image_analysis_*.md`を読み取り
2. 推奨記事日付・時系列情報を確認
3. 各画像の内容を確認（Read tool使用）
4. **📸 重要**: 画像分析MDのURL（`s1000-no-gm`最適化版）をそのまま記事に使用
5. 時系列と内容に基づいて記事作成
6. `posts/YYYY-MM-DD-article-title.md`で保存

### Step 3: 品質チェック・公開
チェックリストに従って最終確認し公開します。

```bash
# ビルド・公開
npm run ビルドして公開
```

## ✅ 記事作成チェックリスト

### 📸 画像処理
- [ ] Google Photos URL抽出完了
- [ ] 画像分析MD作成（時刻情報含む）
- [ ] 各画像の内容確認完了
- [ ] 時系列確認済み

### 📝 記事作成  
- [ ] 日付: 画像分析MDから推奨日付を設定
- [ ] タイトル: 内容に合致したタイトル作成
- [ ] カテゴリ: [標準7カテゴリ](CATEGORY_GUIDE.md)から選択
- [ ] featured_image: 代表画像を設定
- [ ] 最適化URL使用: 画像分析MDの`s1000-no-gm`URLを記事に使用
- [ ] H1タイトル未使用（H2から開始）
- [ ] ファイルパス: `posts/YYYY-MM-DD-title.md`に正しく保存

### ✅ 最終確認
- [ ] 画像と記事内容の整合性確認
- [ ] フロントマター必須項目完備
- [ ] 記事検証実行: `npm run validate` でパス・形式チェック
- [ ] ビルド・公開実行

## 📅 日時情報の自動処理

### EXIF日時抽出
Google Photosからダウンロードされた画像でも`Date/Time Original`が保持されています：

```bash
# 自動抽出される情報例
📅 推奨記事日付: 2024-08-24
⏰ 撮影時間帯: 08:44 - 20:15
⏱️ 撮影期間: 11.5時間
```

### 記事日付決定ルール
*** 記事日付は非常に重要です。写真のTime Originalから必ず確認してください ***
1. **EXIF日時優先**: 最古の撮影日を記事日付とする
2. **時系列確認**: 複数画像の時系列が論理的か確認
3. **手動調整**: 必要に応じてユーザーが最終調整

## 📁 ファイル管理

### 生成される重要ファイル
```
scripts/tmp/
├── review_image_01_hash.jpg      # ダウンロード画像
├── review_image_02_hash.jpg      # ...
└── image_analysis_2024-08-24-article-title.md  # 分析MD（重要）
```

### 画像分析MDの役割
- **時刻情報記録**: 撮影日時と推奨記事日付
- **最適化URL提供**: `s1000-no-gm`形式の高画質URL ⭐
- **画像詳細管理**: 各画像の説明と使用予定
- **チェックリスト提供**: 作業漏れ防止
- **品質管理資料**: 記事作成プロセスの記録

## 🎯 品質保証

### 必須フロントマター項目
```yaml
---
title: "記事タイトル"
date: YYYY-MM-DD          # 画像分析MDから自動決定
category: "標準カテゴリ"    # 7つの標準カテゴリから選択
description: "記事説明"
featured_image: "代表画像URL"
---
```

### 記事構成ルール
- **H1禁止**: 記事内は`## H2`から開始
- **時系列順**: 画像の撮影順に記事を構成
- **画像説明**: 各画像に適切な説明文を付与
- **最適化URL使用**: 画像分析MDの`s1000-no-gm`URLを記事で使用 ⭐

## 🔧 カテゴリ分類

### 標準7カテゴリ
1. **海・潜水** - 素潜り、スピアフィッシング
2. **釣り** - 船釣り、陸釣り
3. **登山・クライミング** - 山岳活動
4. **旅行記** - 観光、イベント参加
5. **ギア・道具** - 商品レビュー
6. **クラフト・DIY** - 手作り作品
7. **山岳ガイド** - 登山情報提供

詳細は[カテゴリ管理ガイド](CATEGORY_GUIDE.md)を参照

## 🚨 よくある問題と解決

### 日時情報が取得できない
```bash
# 手動で日付を推定
# 1. 画像内容から季節・時期を推定
# 2. イベント情報から日付を特定
# 3. ユーザーの記憶・記録から確認
```

### 画像の順序が不適切
```bash
# 時系列チェック
# 1. 撮影時刻を再確認
# 2. 画像内容の論理的順序を確認
# 3. 必要に応じて手動で順序調整
```

### カテゴリ分類に迷う場合
```bash
# 分類基準
# 1. メインの活動内容を特定
# 2. 体験記録 vs 情報提供 で判断
# 3. より具体的なカテゴリを選択
```

## 📚 関連ドキュメント

- [カテゴリ管理ガイド](CATEGORY_GUIDE.md) - カテゴリ分類の詳細
- [開発ガイド](DEVELOPMENT.md) - 技術的な詳細
- [システム仕様](SYSTEM_SPECS.md) - システムの技術仕様
- [トラブルシューティング](TROUBLESHOOTING.md) - 問題解決

## ⚡ 効率化のコツ

### 記事作成前の準備
1. **画像分析MDを必ず確認** - 記事の全体像を把握
2. **推奨日付を活用** - EXIF情報に基づく正確な日付
3. **時系列を意識** - 撮影順序に沿った記事構成

### Claude Code活用
1. **Read tool活用** - 画像内容の正確な把握
2. **分析MD参照** - 時刻情報と詳細データの活用
3. **最適化URL使用** - 分析MDの`s1000-no-gm`URLを記事にそのまま使用 ⭐
4. **チェックリスト実行** - 作業漏れの防止

## ⚠️ 重要な注意事項

### 🔗 画像URL使用について
**必須**: 記事作成時は画像分析MDファイルに記録された`s1000-no-gm`形式のURLを使用してください。

```markdown
<!-- ❌ 間違い: 元のs1621URLや独自変換URL -->
![画像説明](https://lh3.googleusercontent.com/pw/ABC123=s1621?authuser=0)

<!-- ✅ 正解: 画像分析MDファイルのs1000-no-gmURL -->
![画像説明](https://lh3.googleusercontent.com/pw/ABC123=s1000-no-gm?authuser=0)
```

**理由**: 
- 高品質でアスペクト比保持
- ブログ表示に最適なサイズ（1000px内）
- 高解像度ディスプレイでも鮮明に表示

---

**作成日**: 2025年9月3日  
**最終更新**: 2025年9月3日  
**管理者**: Claude Code